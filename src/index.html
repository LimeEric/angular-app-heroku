<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>AngularAppHeroku</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
  <app-root></app-root>
  <script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
  <df-messenger
    intent="WELCOME"
    chat-title="DIRK - Your Virtual Assistant"
    agent-id="249da6ce-8a45-4044-8d6e-f08d3a4bebfd"
    language-code="de"
    chat-icon="https://i.ibb.co/crsHWD0/Avatar-Maker.png"
  ></df-messenger>
  
  <script> 
  function Sleep(milliseconds) {
    return new Promise(resolve => setTimeout(resolve, milliseconds));
  }
  function showArrow(){
    document.getElementById("arrow").style.display="block";
  }

  function hideArrow(){
    document.getElementById("arrow").style.display="none";
  }

  function changeStyle(){
    var heading= document.getElementById("ueberschrift");
    heading.style.color = "#479b3d";
    heading.style.borderColor="red";
    heading.style.borderWidth = "2px";
    heading.style.borderStyle="dashed";
   
  }

  function removeStyle(){
    var heading= document.getElementById("ueberschrift");
    heading.style.color = "black";
    heading.style.border ="none";
  }
   
  function createBox(){
    var div = document.createElement("div");
    div.style.width = "60%px";
    div.style.height = "50px";
    div.style.borderColor = "red";
    div.style.borderWidth = "2px";
    div.style.borderStyle="dashed";
    document.getElementById("ueberschrift").appendChild(div);
    }
    
    const dfMessenger = document.querySelector('df-messenger');
    dfMessenger.addEventListener('df-response-received', async function (event) {
      

      console.log(event);
        if (event.detail.response) {
            data = event.detail.response;
            console.log(data.queryResult.action);
            //now do something with the data JSON object
        }

        if (data.queryResult.action == "input.welcome"){
          //...
          console.log("das klappt");
        }

        if (data.queryResult.intent.displayName == "tools.Spritzwetter"){
          //...
          console.log("das klappt auch");
          for (i=0;i<5;i++){
            showArrow();
            await Sleep(1000);
            hideArrow();
            await Sleep(500);
          }
          //document.getElementById('login').click();
        }
        if(data.queryResult.intent.displayName == "smalltalk.agent.name"){
          changeStyle();
          await Sleep(5000);
          removeStyle();
           }  
    });

  // dfMessenger.addEventListener('df-user-input-entered', function (event) {
 //    if(data.queryResult.intent.displayName == "smalltalk.agent.name"){
   //   changeStyle();
   //  }

  //  });
  </script>
</body>
</html>
